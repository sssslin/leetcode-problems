package com.tags.list.copyRandomList;

import test.BaseSolution;
import test.Node;

import java.util.HashMap;

//ç»™å®šä¸€ä¸ªé“¾è¡¨ï¼Œæ¯ä¸ªèŠ‚ç‚¹åŒ…å«ä¸€ä¸ªé¢å¤–å¢åŠ çš„éšæœºæŒ‡é’ˆï¼Œè¯¥æŒ‡é’ˆå¯ä»¥æŒ‡å‘é“¾è¡¨ä¸­çš„ä»»ä½•èŠ‚ç‚¹æˆ–ç©ºèŠ‚ç‚¹ã€‚
// è¦æ±‚è¿”å›è¿™ä¸ªé“¾è¡¨çš„ æ·±æ‹·è´ã€‚
// æˆ‘ä»¬ç”¨ä¸€ä¸ªç”± n ä¸ªèŠ‚ç‚¹ç»„æˆçš„é“¾è¡¨æ¥è¡¨ç¤ºè¾“å…¥/è¾“å‡ºä¸­çš„é“¾è¡¨ã€‚æ¯ä¸ªèŠ‚ç‚¹ç”¨ä¸€ä¸ª [val, random_index] è¡¨ç¤ºï¼š
// valï¼šä¸€ä¸ªè¡¨ç¤º Node.val çš„æ•´æ•°ã€‚
// random_indexï¼šéšæœºæŒ‡é’ˆæŒ‡å‘çš„èŠ‚ç‚¹ç´¢å¼•ï¼ˆèŒƒå›´ä» 0 åˆ° n-1ï¼‰ï¼›å¦‚æœä¸æŒ‡å‘ä»»ä½•èŠ‚ç‚¹ï¼Œåˆ™ä¸º null ã€‚
// ç¤ºä¾‹ 1ï¼š
// è¾“å…¥ï¼šhead = [[7,null],[13,0],[11,4],[10,2],[1,0]]
//è¾“å‡ºï¼š[[7,null],[13,0],[11,4],[10,2],[1,0]]
// ç¤ºä¾‹ 2ï¼š
// è¾“å…¥ï¼šhead = [[1,1],[2,1]]
//è¾“å‡ºï¼š[[1,1],[2,1]]
// ç¤ºä¾‹ 3ï¼š
// è¾“å…¥ï¼šhead = [[3,null],[3,0],[3,null]]
//è¾“å‡ºï¼š[[3,null],[3,0],[3,null]]
// ç¤ºä¾‹ 4ï¼š
//
// è¾“å…¥ï¼šhead = []
//è¾“å‡ºï¼š[]
//è§£é‡Šï¼šç»™å®šçš„é“¾è¡¨ä¸ºç©ºï¼ˆç©ºæŒ‡é’ˆï¼‰ï¼Œå› æ­¤è¿”å› nullã€‚
// æç¤ºï¼š
// -10000 <= Node.val <= 10000
// Node.random ä¸ºç©ºï¼ˆnullï¼‰æˆ–æŒ‡å‘é“¾è¡¨ä¸­çš„èŠ‚ç‚¹ã€‚
// èŠ‚ç‚¹æ•°ç›®ä¸è¶…è¿‡ 1000 ã€‚
//
// Related Topics å“ˆå¸Œè¡¨ é“¾è¡¨
// ğŸ‘ 417 ğŸ‘ 0

/**
 * time: O(n) space(1);
 * è¯¥è§£æ³•æ˜¯å…¸å‹çš„hashmapçš„åº”ç”¨ï¼šé¢˜æ„ä¸­ï¼Œæ·±æ‹·è´æ„å‘³ç€æ‰€æœ‰æ‹·è´åè·å–çš„æ‰€æœ‰èŠ‚ç‚¹éƒ½ä¸€æ ·ï¼Œ
 * å·§å¦™çš„åœ°æ–¹åœ¨äºï¼Œå¤åˆ¶ä¸¤æ¬¡ï¼Œç¬¬ä¸€æ¬¡åªå¤åˆ¶èŠ‚ç‚¹ï¼Œå¹¶ä¸”ä¸ºä¸‹ä¸€æ¬¡å¤åˆ¶nextå’Œrandomåšå‡†å¤‡ï¼Œ
 * ç”±äºåŸèŠ‚ç‚¹çš„keyå’Œæ–°èŠ‚ç‚¹çš„keyå€¼æ˜¯ä¸€æ ·çš„ï¼Œæ‰€ä»¥å¯ä»¥é€šè¿‡åŸæœ‰çš„keyæ¥å¤åˆ¶æ–°çš„nextå’Œrandom
 */
public class Solution extends BaseSolution {
    public Node copyRandomList(Node head) {

        if (head == null) return null;

        HashMap<Node, Node> map = new HashMap<>();

        // ç¬¬ä¸€éè·å–æ‰€æœ‰çš„èŠ‚ç‚¹
        Node cur = head;
        while (cur != null) {
            map.put(cur, new Node(cur.val));
            cur = cur.next;
        }

        // ç¬¬äºŒéå°†æ‰€æœ‰çš„èŠ‚ç‚¹è¿æ¥èµ·æ¥
        cur = head;
        while (cur != null) {
            map.get(cur).next = map.get(cur.next);
            map.get(cur).random = map.get(cur.random);
            cur = cur.next;
        }
        return map.get(head);
    }
}
